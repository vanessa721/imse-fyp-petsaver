{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport { LinearGradient } from 'expo-linear-gradient';\nimport { collection, doc, getDocs, onSnapshot, orderBy, query } from \"firebase/firestore\";\nimport React, { useEffect, useState } from 'react';\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport View from \"react-native-web/dist/exports/View\";\nimport TouchableHighlight from \"react-native-web/dist/exports/TouchableHighlight\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport { db } from \"../firebase\";\nimport { Avatar, Text, Dialog } from 'react-native-elements';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nexport default function PetSocialMediaScreen(_ref) {\n  var route = _ref.route,\n      navigation = _ref.navigation;\n\n  var _useState = useState(''),\n      _useState2 = _slicedToArray(_useState, 2),\n      ownerName = _useState2[0],\n      setOwnerName = _useState2[1];\n\n  var _useState3 = useState(\"\"),\n      _useState4 = _slicedToArray(_useState3, 2),\n      ownerImagepath = _useState4[0],\n      setOwnerImage = _useState4[1];\n\n  var _useState5 = useState(false),\n      _useState6 = _slicedToArray(_useState5, 2),\n      showImageDialog = _useState6[0],\n      setShowImageDialog = _useState6[1];\n\n  var _useState7 = useState(null),\n      _useState8 = _slicedToArray(_useState7, 2),\n      selectedId = _useState8[0],\n      setSelectedId = _useState8[1];\n\n  var _useState9 = useState(route.params.petPostDataItem.item),\n      _useState10 = _slicedToArray(_useState9, 2),\n      petPostDataItem = _useState10[0],\n      setPetPostDataItem = _useState10[1];\n\n  var _useState11 = useState([]),\n      _useState12 = _slicedToArray(_useState11, 2),\n      socialMediaDataArray = _useState12[0],\n      setSocialMediaDataArray = _useState12[1];\n\n  var getOwnerDetail = function getOwnerDetail() {\n    var unsub;\n    return _regeneratorRuntime.async(function getOwnerDetail$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            if (petPostDataItem.postcreator) {\n              _context.next = 2;\n              break;\n            }\n\n            return _context.abrupt(\"return\", false);\n\n          case 2:\n            unsub = onSnapshot(doc(db, \"Users\", petPostDataItem.postcreator), function (doc) {\n              var _doc$data, _doc$data2;\n\n              if (doc == undefined) return false;\n              if (!doc.data()) return false;\n              setOwnerName((_doc$data = doc.data()) == null ? void 0 : _doc$data.username);\n              setOwnerImage((_doc$data2 = doc.data()) == null ? void 0 : _doc$data2.userIconUri);\n            });\n\n          case 3:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var getData = function getData() {\n    var socialMediaPostRef, q, querySnapshot;\n    return _regeneratorRuntime.async(function getData$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            socialMediaPostRef = collection(db, \"PetPost/\" + petPostDataItem.id + '/socialMediaPost');\n            q = query(socialMediaPostRef, orderBy('createdate', 'desc'));\n            setSocialMediaDataArray([]);\n            _context2.next = 5;\n            return _regeneratorRuntime.awrap(getDocs(q));\n\n          case 5:\n            querySnapshot = _context2.sent;\n            querySnapshot.forEach(function (docSnap) {\n              var newjson = {\n                id: docSnap.id,\n                imagepath: docSnap.data()['imagepath'],\n                caption: docSnap.data()['caption'],\n                createdate: docSnap.data()['createdate']\n              };\n              console.log(\"newjson: \", newjson);\n              setSocialMediaDataArray(function (oldArray) {\n                return [].concat(_toConsumableArray(oldArray), [newjson]);\n              });\n            });\n\n          case 7:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  useEffect(function () {\n    getData();\n    getOwnerDetail();\n  }, []);\n\n  var _renderItem = function renderItem(petPostDataItem) {\n    var backgroundColor = petPostDataItem.index === selectedId ? \"red\" : \"blue\";\n    var color = petPostDataItem.index === selectedId ? 'white' : 'black';\n    return _jsx(View, {\n      style: styles.CardContainer,\n      children: petPostDataItem.item.imagepath != \"\" && _jsxs(View, {\n        children: [_jsx(TouchableHighlight, {\n          onPress: function onPress() {\n            console.log('item:', petPostDataItem);\n            setSelectedId(petPostDataItem.index);\n          },\n          underlayColor: \"white\",\n          children: _jsx(Image, {\n            style: styles.imageitem,\n            source: {\n              uri: petPostDataItem.item.imagepath\n            }\n          })\n        }), _jsxs(Dialog, {\n          isVisible: petPostDataItem.index === selectedId,\n          onBackdropPress: function onBackdropPress() {\n            setSelectedId(null);\n          },\n          children: [_jsx(Image, {\n            style: styles.imageitem,\n            source: {\n              uri: petPostDataItem.item.imagepath\n            }\n          }), _jsx(Text, {\n            children: petPostDataItem.item.caption\n          }), _jsx(Text, {\n            children: timestampToDate(petPostDataItem.item.createdate.seconds)\n          })]\n        })]\n      })\n    });\n  };\n\n  return _jsx(_Fragment, {\n    children: _jsxs(View, {\n      style: styles.container,\n      children: [_jsxs(View, {\n        style: styles.iconContainer,\n        children: [petPostDataItem.imagepath != \"\" && petPostDataItem.imagepath != undefined ? _jsx(Avatar, {\n          size: 100,\n          rounded: true,\n          source: {\n            uri: petPostDataItem.imagepath\n          }\n        }) : _jsx(Avatar, {\n          size: 100,\n          rounded: true,\n          title: petPostDataItem.petname ? petPostDataItem.petname[0] : \"\",\n          containerStyle: {\n            backgroundColor: '#aaaaaa'\n          }\n        }), _jsxs(View, {\n          style: styles.iconDescriptionContainer,\n          children: [_jsx(Text, {\n            style: styles.petname,\n            children: petPostDataItem.petname\n          }), _jsxs(Text, {\n            style: styles.petgender,\n            children: [petPostDataItem.petgender, \"  -  \", petPostDataItem.petstages, \" \"]\n          })]\n        })]\n      }), _jsxs(View, {\n        style: styles.contentContainer,\n        children: [_jsx(Text, {\n          style: {\n            fontSize: 14,\n            marginTop: 12,\n            fontWeight: 'bold'\n          },\n          children: \"Recent Post\"\n        }), _jsx(View, {\n          style: styles.uppergadient,\n          children: _jsx(LinearGradient, {\n            colors: ['white', 'rgba(255,255,255,0)'],\n            style: {\n              height: 40\n            }\n          })\n        }), _jsx(ScrollView, {\n          contentContainerStyle: styles.flexContainer,\n          children: _jsx(FlatList, {\n            showsVerticalScrollIndicator: true,\n            showsHorizontalScrollIndicator: false,\n            data: socialMediaDataArray,\n            renderItem: function renderItem(item) {\n              return _renderItem(item);\n            },\n            keyExtractor: function keyExtractor(item) {\n              return item.id;\n            },\n            numColumns: 3,\n            extraData: selectedId\n          })\n        }), _jsx(View, {\n          style: styles.lowergadient,\n          children: _jsx(LinearGradient, {\n            colors: ['rgba(255,255,255,0)', 'rgba(255,255,255,1)'],\n            style: {\n              height: 40\n            }\n          })\n        })]\n      })]\n    })\n  });\n}\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: 'white',\n    height: \"100%\",\n    flexDirection: 'column'\n  },\n  iconContainer: {\n    padding: 20,\n    alignSelf: 'flex-start',\n    zIndex: 1,\n    flexDirection: 'row'\n  },\n  iconDescriptionContainer: {\n    marginLeft: 20,\n    alignSelf: 'flex-start'\n  },\n  flexContainer: {\n    flex: 1,\n    flexDirection: 'row',\n    flexWrap: 'wrap',\n    alignItems: 'flex-start',\n    justifyContent: 'space-between'\n  },\n  contentContainer: {\n    width: '100%',\n    height: '100%',\n    padding: 30,\n    flex: 1,\n    borderRadius: 25,\n    backgroundColor: 'white',\n    top: -30\n  },\n  uppergadient: {\n    flex: 1,\n    top: 20,\n    width: '100%',\n    height: 40,\n    zIndex: 10,\n    position: 'absolute'\n  },\n  lowergadient: {\n    flex: 1,\n    backgroundColor: 'transparent',\n    position: 'absolute',\n    bottom: 0,\n    width: '100%',\n    height: 40\n  },\n  petname: {\n    fontWeight: 'bold',\n    fontSize: 20\n  },\n  petgender: {\n    fontSize: 10,\n    marginBottom: 12,\n    fontWeight: 'bold',\n    color: '#888888'\n  },\n  CardContainer: {\n    width: '33%',\n    borderColor: '#fefefe',\n    borderWidth: 1\n  },\n  imageitem: {\n    aspectRatio: 1\n  },\n  item: {\n    padding: 20,\n    marginVertical: 8,\n    marginHorizontal: 16\n  },\n  title: {\n    fontSize: 32\n  }\n});\n\nfunction timestampToDate(t) {\n  var date = new Date(t * 1000);\n  var hours = date.getHours();\n  var minutes = \"0\" + date.getMinutes();\n  var seconds = \"0\" + date.getSeconds();\n  var formattedTime = hours + ':' + minutes.substr(-2) + ':' + seconds.substr(-2);\n  return formattedTime;\n}","map":{"version":3,"sources":["C:/Users/ZZ00UI738/Documents/van fyp/petsaver/screens/PetSocialMediaScreen.tsx"],"names":["LinearGradient","collection","doc","getDocs","onSnapshot","orderBy","query","React","useEffect","useState","db","Avatar","Text","Dialog","PetSocialMediaScreen","route","navigation","ownerName","setOwnerName","ownerImagepath","setOwnerImage","showImageDialog","setShowImageDialog","selectedId","setSelectedId","params","petPostDataItem","item","setPetPostDataItem","socialMediaDataArray","setSocialMediaDataArray","getOwnerDetail","postcreator","unsub","undefined","data","username","userIconUri","getData","socialMediaPostRef","id","q","querySnapshot","forEach","docSnap","newjson","imagepath","caption","createdate","console","log","oldArray","renderItem","backgroundColor","index","color","styles","CardContainer","imageitem","uri","timestampToDate","seconds","container","iconContainer","petname","iconDescriptionContainer","petgender","petstages","contentContainer","fontSize","marginTop","fontWeight","uppergadient","height","flexContainer","lowergadient","StyleSheet","create","flex","flexDirection","padding","alignSelf","zIndex","marginLeft","flexWrap","alignItems","justifyContent","width","borderRadius","top","position","bottom","marginBottom","borderColor","borderWidth","aspectRatio","marginVertical","marginHorizontal","title","t","date","Date","hours","getHours","minutes","getMinutes","getSeconds","formattedTime","substr"],"mappings":";;;AAAA,SAASA,cAAT,QAA+B,sBAA/B;AACA,SAASC,UAAT,EAAqBC,GAArB,EAA0BC,OAA1B,EAAmCC,UAAnC,EAA+CC,OAA/C,EAAwDC,KAAxD,QAAqE,oBAArE;AACA,OAAOC,KAAP,IAAgBC,SAAhB,EAA2BC,QAA3B,QAA2C,OAA3C;;;;;;;AAIA,SAASC,EAAT;AACA,SAAeC,MAAf,EAAuBC,IAAvB,EAAoEC,MAApE,QAAkF,uBAAlF;;;;AAOA,eAAe,SAASC,oBAAT,OAAsF;AAAA,MAAtDC,KAAsD,QAAtDA,KAAsD;AAAA,MAA/CC,UAA+C,QAA/CA,UAA+C;;AACnG,kBAAkCP,QAAQ,CAAqB,EAArB,CAA1C;AAAA;AAAA,MAAOQ,SAAP;AAAA,MAAkBC,YAAlB;;AACA,mBAAwCT,QAAQ,CAAC,EAAD,CAAhD;AAAA;AAAA,MAAOU,cAAP;AAAA,MAAuBC,aAAvB;;AAEA,mBAA8CX,QAAQ,CAAC,KAAD,CAAtD;AAAA;AAAA,MAAOY,eAAP;AAAA,MAAwBC,kBAAxB;;AACA,mBAAoCb,QAAQ,CAAC,IAAD,CAA5C;AAAA;AAAA,MAAOc,UAAP;AAAA,MAAmBC,aAAnB;;AAGA,mBAA8Cf,QAAQ,CAACM,KAAK,CAACU,MAAN,CAAaC,eAAb,CAA6BC,IAA9B,CAAtD;AAAA;AAAA,MAAOD,eAAP;AAAA,MAAwBE,kBAAxB;;AACA,oBAAwDnB,QAAQ,CAAyB,EAAzB,CAAhE;AAAA;AAAA,MAAOoB,oBAAP;AAAA,MAA6BC,uBAA7B;;AAEA,MAAMC,cAAc,GAAG,SAAjBA,cAAiB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAChBL,eAAe,CAACM,WADA;AAAA;AAAA;AAAA;;AAAA,6CACoB,KADpB;;AAAA;AAGfC,YAAAA,KAHe,GAGP7B,UAAU,CAACF,GAAG,CAACQ,EAAD,EAAK,OAAL,EAAcgB,eAAe,CAACM,WAA9B,CAAJ,EAAgD,UAAC9B,GAAD,EAAS;AAAA;;AAC/E,kBAAIA,GAAG,IAAIgC,SAAX,EAAsB,OAAO,KAAP;AACtB,kBAAI,CAAChC,GAAG,CAACiC,IAAJ,EAAL,EAAiB,OAAO,KAAP;AACjBjB,cAAAA,YAAY,cAAChB,GAAG,CAACiC,IAAJ,EAAD,qBAAC,UAAYC,QAAb,CAAZ;AACAhB,cAAAA,aAAa,eAAClB,GAAG,CAACiC,IAAJ,EAAD,qBAAC,WAAYE,WAAb,CAAb;AACD,aALuB,CAHH;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAvB;;AAWA,MAAMC,OAAO,GAAG,SAAVA,OAAU;AAAA;AAAA;AAAA;AAAA;AAAA;AAEVC,YAAAA,kBAFU,GAEWtC,UAAU,CAACS,EAAD,EAAK,aAAagB,eAAe,CAACc,EAA7B,GAAkC,kBAAvC,CAFrB;AAIRC,YAAAA,CAJQ,GAIJnC,KAAK,CAACiC,kBAAD,EAAqBlC,OAAO,CAAC,YAAD,EAAe,MAAf,CAA5B,CAJD;AAKdyB,YAAAA,uBAAuB,CAAC,EAAD,CAAvB;AALc;AAAA,6CAMc3B,OAAO,CAACsC,CAAD,CANrB;;AAAA;AAMRC,YAAAA,aANQ;AAOdA,YAAAA,aAAa,CAACC,OAAd,CAAsB,UAACC,OAAD,EAAa;AACjC,kBAAMC,OAAO,GAAG;AACdL,gBAAAA,EAAE,EAAEI,OAAO,CAACJ,EADE;AAEdM,gBAAAA,SAAS,EAAEF,OAAO,CAACT,IAAR,GAAe,WAAf,CAFG;AAGdY,gBAAAA,OAAO,EAAEH,OAAO,CAACT,IAAR,GAAe,SAAf,CAHK;AAIda,gBAAAA,UAAU,EAAEJ,OAAO,CAACT,IAAR,GAAe,YAAf;AAJE,eAAhB;AAMAc,cAAAA,OAAO,CAACC,GAAR,CAAY,WAAZ,EAAyBL,OAAzB;AACAf,cAAAA,uBAAuB,CAAC,UAAAqB,QAAQ;AAAA,oDAAQA,QAAR,IAAkBN,OAAlB;AAAA,eAAT,CAAvB;AACD,aATD;;AAPc;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAhB;;AAoBArC,EAAAA,SAAS,CAAC,YAAM;AACd8B,IAAAA,OAAO;AACPP,IAAAA,cAAc;AACf,GAHQ,EAGN,EAHM,CAAT;;AAKA,MAAMqB,WAAU,GAAG,SAAbA,UAAa,CAAC1B,eAAD,EAA0B;AAC3C,QAAM2B,eAAe,GAAG3B,eAAe,CAAC4B,KAAhB,KAA0B/B,UAA1B,GAAuC,KAAvC,GAA+C,MAAvE;AACA,QAAMgC,KAAK,GAAG7B,eAAe,CAAC4B,KAAhB,KAA0B/B,UAA1B,GAAuC,OAAvC,GAAiD,OAA/D;AAEA,WAaE,KAAC,IAAD;AAAM,MAAA,KAAK,EAAEiC,MAAM,CAACC,aAApB;AAAA,gBAEI/B,eAAe,CAACC,IAAhB,CAAqBmB,SAArB,IAAkC,EAAlC,IACA,MAAC,IAAD;AAAA,mBACE,KAAC,kBAAD;AACE,UAAA,OAAO,EAAE,mBAAM;AACbG,YAAAA,OAAO,CAACC,GAAR,CAAY,OAAZ,EAAqBxB,eAArB;AACAF,YAAAA,aAAa,CAACE,eAAe,CAAC4B,KAAjB,CAAb;AACD,WAJH;AAKE,UAAA,aAAa,EAAC,OALhB;AAAA,oBAOE,KAAC,KAAD;AAAO,YAAA,KAAK,EAAEE,MAAM,CAACE,SAArB;AACE,YAAA,MAAM,EAAE;AAAEC,cAAAA,GAAG,EAAEjC,eAAe,CAACC,IAAhB,CAAqBmB;AAA5B;AADV;AAPF,UADF,EAcE,MAAC,MAAD;AAAQ,UAAA,SAAS,EAAEpB,eAAe,CAAC4B,KAAhB,KAA0B/B,UAA7C;AACE,UAAA,eAAe,EAAE,2BAAM;AAErBC,YAAAA,aAAa,CAAC,IAAD,CAAb;AACD,WAJH;AAAA,qBAKE,KAAC,KAAD;AAAO,YAAA,KAAK,EAAEgC,MAAM,CAACE,SAArB;AACE,YAAA,MAAM,EAAE;AAAEC,cAAAA,GAAG,EAAEjC,eAAe,CAACC,IAAhB,CAAqBmB;AAA5B;AADV,YALF,EAQE,KAAC,IAAD;AAAA,sBAAOpB,eAAe,CAACC,IAAhB,CAAqBoB;AAA5B,YARF,EASE,KAAC,IAAD;AAAA,sBAAOa,eAAe,CAAClC,eAAe,CAACC,IAAhB,CAAqBqB,UAArB,CAAgCa,OAAjC;AAAtB,YATF;AAAA,UAdF;AAAA;AAHJ,MAbF;AA8CD,GAlDD;;AAqDA,SACE;AAAA,cACE,MAAC,IAAD;AAAM,MAAA,KAAK,EAAEL,MAAM,CAACM,SAApB;AAAA,iBACE,MAAC,IAAD;AAAM,QAAA,KAAK,EAAEN,MAAM,CAACO,aAApB;AAAA,mBACIrC,eAAe,CAACoB,SAAhB,IAA6B,EAA7B,IAAmCpB,eAAe,CAACoB,SAAhB,IAA6BZ,SAAjE,GAEC,KAAC,MAAD;AACE,UAAA,IAAI,EAAE,GADR;AAEE,UAAA,OAAO,MAFT;AAGE,UAAA,MAAM,EAAE;AAAEyB,YAAAA,GAAG,EAAEjC,eAAe,CAACoB;AAAvB;AAHV,UAFD,GAOG,KAAC,MAAD;AACA,UAAA,IAAI,EAAE,GADN;AAEA,UAAA,OAAO,MAFP;AAGA,UAAA,KAAK,EAAEpB,eAAe,CAACsC,OAAhB,GAA0BtC,eAAe,CAACsC,OAAhB,CAAwB,CAAxB,CAA1B,GAAuD,EAH9D;AAIA,UAAA,cAAc,EAAE;AAAEX,YAAAA,eAAe,EAAE;AAAnB;AAJhB,UARN,EAeE,MAAC,IAAD;AAAM,UAAA,KAAK,EAAEG,MAAM,CAACS,wBAApB;AAAA,qBACE,KAAC,IAAD;AAAM,YAAA,KAAK,EAAET,MAAM,CAACQ,OAApB;AAAA,sBAA8BtC,eAAe,CAACsC;AAA9C,YADF,EAEE,MAAC,IAAD;AAAM,YAAA,KAAK,EAAER,MAAM,CAACU,SAApB;AAAA,uBAAgCxC,eAAe,CAACwC,SAAhD,WAAgExC,eAAe,CAACyC,SAAhF;AAAA,YAFF;AAAA,UAfF;AAAA,QADF,EAsBE,MAAC,IAAD;AAAM,QAAA,KAAK,EAAEX,MAAM,CAACY,gBAApB;AAAA,mBACE,KAAC,IAAD;AAAM,UAAA,KAAK,EAAE;AAAEC,YAAAA,QAAQ,EAAE,EAAZ;AAAgBC,YAAAA,SAAS,EAAE,EAA3B;AAA+BC,YAAAA,UAAU,EAAE;AAA3C,WAAb;AAAA;AAAA,UADF,EAEE,KAAC,IAAD;AAAM,UAAA,KAAK,EAAEf,MAAM,CAACgB,YAApB;AAAA,oBACE,KAAC,cAAD;AACE,YAAA,MAAM,EAAE,CAAC,OAAD,EAAU,qBAAV,CADV;AAEE,YAAA,KAAK,EAAE;AAAEC,cAAAA,MAAM,EAAE;AAAV;AAFT;AADF,UAFF,EAQE,KAAC,UAAD;AACE,UAAA,qBAAqB,EAAEjB,MAAM,CAACkB,aADhC;AAAA,oBAEE,KAAC,QAAD;AACE,YAAA,4BAA4B,EAAE,IADhC;AAEE,YAAA,8BAA8B,EAAE,KAFlC;AAGE,YAAA,IAAI,EAAE7C,oBAHR;AAIE,YAAA,UAAU,EAAE,oBAACF,IAAD;AAAA,qBAAUyB,WAAU,CAACzB,IAAD,CAApB;AAAA,aAJd;AAKE,YAAA,YAAY,EAAE,sBAAAA,IAAI;AAAA,qBAAIA,IAAI,CAACa,EAAT;AAAA,aALpB;AAME,YAAA,UAAU,EAAE,CANd;AAOE,YAAA,SAAS,EAAEjB;AAPb;AAFF,UARF,EAqBE,KAAC,IAAD;AAAM,UAAA,KAAK,EAAEiC,MAAM,CAACmB,YAApB;AAAA,oBACE,KAAC,cAAD;AACE,YAAA,MAAM,EAAE,CAAC,qBAAD,EAAwB,qBAAxB,CADV;AAEE,YAAA,KAAK,EAAE;AAAEF,cAAAA,MAAM,EAAE;AAAV;AAFT;AADF,UArBF;AAAA,QAtBF;AAAA;AADF,IADF;AAwDD;AAID,IAAMjB,MAAM,GAAGoB,UAAU,CAACC,MAAX,CAAkB;AAC/Bf,EAAAA,SAAS,EAAE;AACTgB,IAAAA,IAAI,EAAE,CADG;AAETzB,IAAAA,eAAe,EAAE,OAFR;AAGToB,IAAAA,MAAM,EAAE,MAHC;AAITM,IAAAA,aAAa,EAAE;AAJN,GADoB;AAO/BhB,EAAAA,aAAa,EAAE;AACbiB,IAAAA,OAAO,EAAE,EADI;AAEbC,IAAAA,SAAS,EAAE,YAFE;AAGbC,IAAAA,MAAM,EAAE,CAHK;AAIbH,IAAAA,aAAa,EAAE;AAJF,GAPgB;AAa/Bd,EAAAA,wBAAwB,EAAE;AACxBkB,IAAAA,UAAU,EAAE,EADY;AAExBF,IAAAA,SAAS,EAAE;AAFa,GAbK;AAiB/BP,EAAAA,aAAa,EAAE;AACbI,IAAAA,IAAI,EAAE,CADO;AAEbC,IAAAA,aAAa,EAAE,KAFF;AAGbK,IAAAA,QAAQ,EAAE,MAHG;AAIbC,IAAAA,UAAU,EAAE,YAJC;AAKbC,IAAAA,cAAc,EAAE;AALH,GAjBgB;AAwB/BlB,EAAAA,gBAAgB,EAAE;AAChBmB,IAAAA,KAAK,EAAE,MADS;AAEhBd,IAAAA,MAAM,EAAE,MAFQ;AAGhBO,IAAAA,OAAO,EAAE,EAHO;AAKhBF,IAAAA,IAAI,EAAE,CALU;AAMhBU,IAAAA,YAAY,EAAE,EANE;AAOhBnC,IAAAA,eAAe,EAAE,OAPD;AAQhBoC,IAAAA,GAAG,EAAE,CAAC;AARU,GAxBa;AAkC/BjB,EAAAA,YAAY,EAAE;AACZM,IAAAA,IAAI,EAAE,CADM;AAGZW,IAAAA,GAAG,EAAE,EAHO;AAIZF,IAAAA,KAAK,EAAE,MAJK;AAKZd,IAAAA,MAAM,EAAE,EALI;AAMZS,IAAAA,MAAM,EAAE,EANI;AAOZQ,IAAAA,QAAQ,EAAE;AAPE,GAlCiB;AA2C/Bf,EAAAA,YAAY,EAAE;AACZG,IAAAA,IAAI,EAAE,CADM;AAEZzB,IAAAA,eAAe,EAAE,aAFL;AAGZqC,IAAAA,QAAQ,EAAE,UAHE;AAIZC,IAAAA,MAAM,EAAE,CAJI;AAKZJ,IAAAA,KAAK,EAAE,MALK;AAMZd,IAAAA,MAAM,EAAE;AANI,GA3CiB;AAmD/BT,EAAAA,OAAO,EAAE;AACPO,IAAAA,UAAU,EAAE,MADL;AAEPF,IAAAA,QAAQ,EAAE;AAFH,GAnDsB;AAuD/BH,EAAAA,SAAS,EAAE;AACTG,IAAAA,QAAQ,EAAE,EADD;AACKuB,IAAAA,YAAY,EAAE,EADnB;AACuBrB,IAAAA,UAAU,EAAE,MADnC;AAC2ChB,IAAAA,KAAK,EAAE;AADlD,GAvDoB;AA0D/BE,EAAAA,aAAa,EAAE;AACb8B,IAAAA,KAAK,EAAE,KADM;AAEbM,IAAAA,WAAW,EAAE,SAFA;AAGbC,IAAAA,WAAW,EAAE;AAHA,GA1DgB;AA+D/BpC,EAAAA,SAAS,EAAE;AACTqC,IAAAA,WAAW,EAAE;AADJ,GA/DoB;AAkE/BpE,EAAAA,IAAI,EAAE;AACJqD,IAAAA,OAAO,EAAE,EADL;AAEJgB,IAAAA,cAAc,EAAE,CAFZ;AAGJC,IAAAA,gBAAgB,EAAE;AAHd,GAlEyB;AAuE/BC,EAAAA,KAAK,EAAE;AACL7B,IAAAA,QAAQ,EAAE;AADL;AAvEwB,CAAlB,CAAf;;AA8EA,SAAST,eAAT,CAAyBuC,CAAzB,EAAoC;AAClC,MAAIC,IAAI,GAAG,IAAIC,IAAJ,CAASF,CAAC,GAAG,IAAb,CAAX;AAEA,MAAIG,KAAK,GAAGF,IAAI,CAACG,QAAL,EAAZ;AAEA,MAAIC,OAAO,GAAG,MAAMJ,IAAI,CAACK,UAAL,EAApB;AAEA,MAAI5C,OAAO,GAAG,MAAMuC,IAAI,CAACM,UAAL,EAApB;AAEA,MAAIC,aAAa,GAAGL,KAAK,GAAG,GAAR,GAAcE,OAAO,CAACI,MAAR,CAAe,CAAC,CAAhB,CAAd,GAAmC,GAAnC,GAAyC/C,OAAO,CAAC+C,MAAR,CAAe,CAAC,CAAhB,CAA7D;AAEA,SAAOD,aAAP;AAED","sourcesContent":["import { LinearGradient } from 'expo-linear-gradient';\nimport { collection, doc, getDocs, onSnapshot, orderBy, query } from \"firebase/firestore\";\nimport React, { useEffect, useState } from 'react';\nimport { FlatList, ScrollView, StyleSheet, View, TouchableHighlight, TouchableOpacity, Image } from 'react-native';\nimport { PetSocialMediaCard } from '../components/PetSocialMediaCard';\nimport { SocialMediaFlatList } from '../components/SocialMediaFlatList';\nimport { db } from \"../firebase\";\nimport { Card, Avatar, Text, Input, Icon, SearchBar, Button, Badge, Dialog } from 'react-native-elements';\n\nimport { socialMediaDataProps } from '../types';\n\n\n\n\nexport default function PetSocialMediaScreen({ route, navigation }: { route: any, navigation: any }) {\n  const [ownerName, setOwnerName] = useState<string | undefined>('');\n  const [ownerImagepath, setOwnerImage] = useState(\"\");\n\n  const [showImageDialog, setShowImageDialog] = useState(false)\n  const [selectedId, setSelectedId] = useState(null);\n\n\n  const [petPostDataItem, setPetPostDataItem] = useState(route.params.petPostDataItem.item)\n  const [socialMediaDataArray, setSocialMediaDataArray] = useState<socialMediaDataProps[]>([]);\n\n  const getOwnerDetail = async () => {\n    if (!petPostDataItem.postcreator) return false;\n\n    const unsub = onSnapshot(doc(db, \"Users\", petPostDataItem.postcreator), (doc) => {\n      if (doc == undefined) return false;\n      if (!doc.data()) return false;\n      setOwnerName(doc.data()?.username)\n      setOwnerImage(doc.data()?.userIconUri)\n    });\n  }\n\n  const getData = async () => {\n\n    var socialMediaPostRef = collection(db, \"PetPost/\" + petPostDataItem.id + '/socialMediaPost');\n\n    const q = query(socialMediaPostRef, orderBy('createdate', 'desc'));\n    setSocialMediaDataArray([])\n    const querySnapshot = await getDocs(q);\n    querySnapshot.forEach((docSnap) => {\n      const newjson = {\n        id: docSnap.id,\n        imagepath: docSnap.data()['imagepath'],\n        caption: docSnap.data()['caption'],\n        createdate: docSnap.data()['createdate'],\n      }\n      console.log(\"newjson: \", newjson)\n      setSocialMediaDataArray(oldArray => [...oldArray, newjson]);\n    });\n\n  }\n\n  useEffect(() => {\n    getData()\n    getOwnerDetail();\n  }, []);\n\n  const renderItem = (petPostDataItem: any) => {\n    const backgroundColor = petPostDataItem.index === selectedId ? \"red\" : \"blue\";\n    const color = petPostDataItem.index === selectedId ? 'white' : 'black';\n\n    return (\n\n      // <TouchableOpacity onPress={() => {\n      //   console.log('item:', item)\n      //   setSelectedId(item.index);\n      // }} style={{\n      //   padding: 20,\n      //   marginVertical: 8,\n      //   marginHorizontal: 16, backgroundColor: backgroundColor\n      // }}>\n      //   <Text style={{ fontSize: 32, color: color }}>{item.title}</Text>\n      // </TouchableOpacity>\n\n      <View style={styles.CardContainer}>\n        {\n          petPostDataItem.item.imagepath != \"\" &&\n          <View>\n            <TouchableHighlight\n              onPress={() => {\n                console.log('item:', petPostDataItem)\n                setSelectedId(petPostDataItem.index);\n              }}\n              underlayColor=\"white\">\n\n              <Image style={styles.imageitem}\n                source={{ uri: petPostDataItem.item.imagepath }}\n              />\n            </TouchableHighlight >\n\n\n            <Dialog isVisible={petPostDataItem.index === selectedId}\n              onBackdropPress={() => {\n\n                setSelectedId(null);\n              }}>\n              <Image style={styles.imageitem}\n                source={{ uri: petPostDataItem.item.imagepath }}\n              />\n              <Text>{petPostDataItem.item.caption}</Text>\n              <Text>{timestampToDate(petPostDataItem.item.createdate.seconds)}</Text>\n            </Dialog>\n          </View>\n\n        }\n      </View >\n    );\n  };\n\n\n  return (\n    <>\n      <View style={styles.container}>\n        <View style={styles.iconContainer}>\n          {(petPostDataItem.imagepath != \"\" && petPostDataItem.imagepath != undefined) ?\n\n            <Avatar\n              size={100}\n              rounded\n              source={{ uri: petPostDataItem.imagepath }}\n            />\n            : <Avatar\n              size={100}\n              rounded\n              title={petPostDataItem.petname ? petPostDataItem.petname[0] : \"\"}\n              containerStyle={{ backgroundColor: '#aaaaaa' }}\n            />\n          }\n          <View style={styles.iconDescriptionContainer}>\n            <Text style={styles.petname}>{petPostDataItem.petname}</Text>\n            <Text style={styles.petgender}>{petPostDataItem.petgender}  -  {petPostDataItem.petstages} </Text>\n          </View>\n        </View>\n\n        <View style={styles.contentContainer}>\n          <Text style={{ fontSize: 14, marginTop: 12, fontWeight: 'bold' }}>Recent Post</Text>\n          <View style={styles.uppergadient}>\n            <LinearGradient\n              colors={['white', 'rgba(255,255,255,0)']}\n              style={{ height: 40 }}\n            />\n          </View>\n          <ScrollView\n            contentContainerStyle={styles.flexContainer}>\n            <FlatList\n              showsVerticalScrollIndicator={true}\n              showsHorizontalScrollIndicator={false}\n              data={socialMediaDataArray}\n              renderItem={(item) => renderItem(item)}\n              keyExtractor={item => item.id}\n              numColumns={3}\n              extraData={selectedId}\n\n            />\n          </ScrollView>\n          <View style={styles.lowergadient}>\n            <LinearGradient\n              colors={['rgba(255,255,255,0)', 'rgba(255,255,255,1)']}\n              style={{ height: 40 }}\n            />\n          </View>\n        </View>\n\n      </View >\n    </>\n  );\n}\n\n\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: 'white',\n    height: \"100%\",\n    flexDirection: 'column'\n  },\n  iconContainer: {\n    padding: 20,\n    alignSelf: 'flex-start',\n    zIndex: 1,\n    flexDirection: 'row'\n  },\n  iconDescriptionContainer: {\n    marginLeft: 20,\n    alignSelf: 'flex-start'\n  },\n  flexContainer: {\n    flex: 1,\n    flexDirection: 'row',\n    flexWrap: 'wrap',\n    alignItems: 'flex-start',\n    justifyContent: 'space-between'\n  },\n  contentContainer: {\n    width: '100%',\n    height: '100%',\n    padding: 30,\n\n    flex: 1,\n    borderRadius: 25,\n    backgroundColor: 'white',\n    top: -30\n  },\n  uppergadient: {\n    flex: 1,\n    //backgroundColor: 'white',\n    top: 20,\n    width: '100%',\n    height: 40,\n    zIndex: 10,\n    position: 'absolute'\n  },\n  lowergadient: {\n    flex: 1,\n    backgroundColor: 'transparent',\n    position: 'absolute',\n    bottom: 0,\n    width: '100%',\n    height: 40\n  },\n  petname: {\n    fontWeight: 'bold',\n    fontSize: 20\n  },\n  petgender: {\n    fontSize: 10, marginBottom: 12, fontWeight: 'bold', color: '#888888'\n  },\n  CardContainer: {\n    width: '33%',\n    borderColor: '#fefefe',\n    borderWidth: 1\n  },\n  imageitem: {\n    aspectRatio: 1,\n  },\n  item: {\n    padding: 20,\n    marginVertical: 8,\n    marginHorizontal: 16,\n  },\n  title: {\n    fontSize: 32,\n  },\n\n\n});\n\nfunction timestampToDate(t: number) {\n  var date = new Date(t * 1000);\n\n  var hours = date.getHours();\n\n  var minutes = \"0\" + date.getMinutes();\n\n  var seconds = \"0\" + date.getSeconds();\n\n  var formattedTime = hours + ':' + minutes.substr(-2) + ':' + seconds.substr(-2);\n\n  return formattedTime;\n\n}\n\n\n"]},"metadata":{},"sourceType":"module"}